/*
 * twoWayScroll - Infinite loading data or images on web pages by two-way scroll
 *
 * @copyright Jerry Chen
 * @license MIT License
 * @author Jerry Chen (https://github.com/ordinary9843/twoWayScroll)
 * @version 1.1.1
 * @requires jQuery v1.9.1+
 */
!function(u){"use strict";function l(d,t){var e=d.data("twoWayScroll");let o={};t&&(o="function"==typeof t?{done:t}:t);let c=u.extend({},u.twoWayScroll.defaults,o,e||{});var f="visible"===d.css("overflow-y");let l=d.find(c.prevSelector).first(),r=d.find(c.nextSelector).first(),p=u(window),n=u("body"),s=f?p:d;function g(){d.find(".twoWayScroll-inner").length||d.contents().wrapAll('<div class="twoWayScroll-inner" />')}function i(t){let e;c.pagingSelector?t.closest(c.pagingSelector).hide():(e=t.parent().not(".twoWayScroll-inner, .twoWayScroll-added").addClass("twoWayScroll-parent").hide(),e.length||t.wrap('<div class="twoWayScroll-parent" />').parent().hide())}function a(){return s.unbind(".twoWayScroll").removeData("twoWayScroll").find(".twoWayScroll-inner").children().unwrap().filter(".twoWayScroll-added").children().unwrap()}function h(){if(d.is(":visible")){g();let t=d.find("div.twoWayScroll-inner").first(),e=d.data("twoWayScroll");var r,n=parseInt(d.css("borderTopWidth"),10),i=isNaN(n)?0:n,a=parseInt(d.css("paddingTop"),10)+i,n=f?s.scrollTop():d.offset().top,i=t.length?t.offset().top:0,a=Math.ceil(n-i+s.height()+a);let o="undefined",l="undefined";return!e.prevHref||(r=e.prevHref.split(" "))[0]&&(o=r[0]),!e.nextHref||(r=e.nextHref.split(" "))[0]&&(l=r[0]),!e.prevWaiting&&"undefined"!==o&&a+c.padding<p.height()*c.prevLoadHeight?(!0===c.replaceState&&history.replaceState(null,document.title,o),W()):!e.nextWaiting&&"undefined"!==l&&a+c.padding>=t.outerHeight()?(!0===c.replaceState&&history.replaceState(null,document.title,l),y()):void 0}}var S=u.trim(l.prop("href")+" "+c.contentSelector),t=u.trim(r.prop("href")+" "+c.contentSelector);let w=function(){var t=d.find(c.prevSelector).first(),e=d.find(c.nextSelector).first();t.length&&(i(t),t=n.height()-d.offset().top,t=d.height()<t?d.height():t,(0<d.offset().top-p.scrollTop()?p.height()-(d.offset().top-u(window).scrollTop()):p.height())<t&&h(),s.unbind(".twoWayScroll").bind("scroll.twoWayScroll",h)),e.length&&(i(e),e=n.height()-d.offset().top,(d.height()<e?d.height():e)<=(0<d.offset().top-p.scrollTop()?p.height()-(d.offset().top-u(window).scrollTop()):p.height())&&h(),s.unbind(".twoWayScroll").bind("scroll.twoWayScroll",h))},W=function(){let t=d.find("div.twoWayScroll-inner").first(),n=d.data("twoWayScroll");return n.prevWaiting=!0,t.prepend('<div class="twoWayScroll-added" />').children(".twoWayScroll-added").first().html('<div class="twoWayScroll-loading" id="twoWayScroll-loading">'+c.loadingHtml+"</div>").promise().done(function(){c.loading&&c.loading()}),d.animate({scrollTop:t.outerHeight()},0,function(){let r=n.prevHref;t.find("div.twoWayScroll-added").first().load(r,function(t,e){if("error"===e)return a();let o=u(this).find(c.prevSelector).first();var l;n.prevWaiting=!1,n.prevHref=!!o.prop("href")&&u.trim(o.prop("href")+" "+c.contentSelector),u(".twoWayScroll-parent",d).remove(),p.scrollTop(u(window).height()),(l=l||d.data("twoWayScroll"))&&l.prevHref&&w(),c.done&&(l=(e=r.split(" "))[0],e=e[1],c.done.call(this,l,e))})})},y=function(){let t=d.find("div.twoWayScroll-inner").first(),n=d.data("twoWayScroll");return n.nextWaiting=!0,t.append('<div class="twoWayScroll-added" />').children(".twoWayScroll-added").last().html('<div class="twoWayScroll-loading" id="twoWayScroll-loading">'+c.loadingHtml+"</div>").promise().done(function(){c.loading&&c.loading()}),d.animate({scrollTop:t.outerHeight()},0,function(){let r=n.nextHref;t.find("div.twoWayScroll-added").last().load(r,function(t,e){if("error"===e)return a();let o=u(this).find(c.nextSelector).first();var l;n.nextWaiting=!1,n.nextHref=!!o.prop("href")&&u.trim(o.prop("href")+" "+c.contentSelector),u(".twoWayScroll-parent",d).remove(),(l=l||d.data("twoWayScroll"))&&l.nextHref&&w(),c.done&&(l=(e=r.split(" "))[0],e=e[1],c.done.call(this,l,e))})})};return d.data("twoWayScroll",u.extend({},e,{initialized:!0,prevWaiting:!1,nextWaiting:!1,prevHref:S,nextHref:t})),g(),function(){var e=u(c.loadingHtml).filter("img").attr("src");if(e){let t=new Image;t.src=e}}(),w(),u.extend(d.twoWayScroll,{destroy:a}),d}u.twoWayScroll={defaults:{replaceState:!0,padding:0,prevLoadHeight:1,prevSelector:'.pagination .page-link[rel="prev"]',nextSelector:'.pagination .page-link[rel="next"]',contentSelector:".two-way-scroll",pagingSelector:"ul.pagination",loadingHtml:"<span>Loading</span>",loading:!1,done:!1}},u.fn.twoWayScroll=function(o){return this.each(function(){let t=u(this);var e=t.data("twoWayScroll");e&&e.initialized||l(t,o)})}}(jQuery);